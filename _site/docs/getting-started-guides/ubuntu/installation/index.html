
  
    
    

  

  
    
    

  

  
    

<!Doctype html>
<html id="docs" class="Setup">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="Setting up Kubernetes with Juju" />
    

    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Setting up Kubernetes with Juju | Kubernetes</title>
<meta property="og:title" content="Setting up Kubernetes with Juju" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://0.0.0.0:4000/docs/getting-started-guides/ubuntu/installation/" />
<meta property="og:url" content="http://0.0.0.0:4000/docs/getting-started-guides/ubuntu/installation/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"name":null,"description":"Production-Grade Container Orchestration","author":null,"@type":"WebPage","url":"http://0.0.0.0:4000/docs/getting-started-guides/ubuntu/installation/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4000/images/favicon.png"}},"image":null,"headline":"Setting up Kubernetes with Juju","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/home/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
            <li>
                <a href="#">
                    v1.8 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                  <li><a href="https://kubernetes.io/docs/home/">v1.8</a></li>
                
                  <li><a href="https://v1-7.docs.kubernetes.io/docs/home/">v1.7</a></li>
                
                  <li><a href="https://v1-6.docs.kubernetes.io/docs/home/">v1.6</a></li>
                
                  <li><a href="https://v1-5.docs.kubernetes.io/docs/">v1.5</a></li>
                
                  <li><a href="https://v1-4.docs.kubernetes.io/docs/">v1.4</a></li>
                
                </ul>
              </li>
            </li>
        </ul>
        <!-- <a href="/docs/home" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Setup</h1>
  <h5>Instructions for setting up a Kubernetes cluster.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/home/" >HOME</a></li>
      <li><a href="/docs/setup/" class="YAH">SETUP</a></li>
      <li><a href="/docs/concepts/" >CONCEPTS</a></li>
      <li><a href="/docs/tasks/" >TASKS</a></li>
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="Setup" href="/docs/setup/"></a>
    
  

  

    

    
      <a class="item" data-title="Picking the Right Solution" href="/docs/setup/pick-right-solution/"></a>
    
  

  
    <div class="item" data-title="Independent Solutions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Running Kubernetes Locally via Minikube" href="/docs/getting-started-guides/minikube/"></a>
    
  

  
    <div class="item" data-title="Bootstrapping Clusters with kubeadm">
      <div class="container">
        
  

    

    
      <a class="item" data-title="安装 kubeadm" href="/docs/setup/independent/install-kubeadm/"></a>
    
  

  

    

    
      <a class="item" data-title="Using kubeadm to Create a Cluster" href="/docs/setup/independent/create-cluster-kubeadm/"></a>
    
  

  

    

    
      <a class="item" data-title="Troubleshooting kubeadm" href="/docs/setup/independent/troubleshooting-kubeadm/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="从零开始搭建自定义集群" href="/docs/getting-started-guides/scratch/"></a>
    
  

  

    

    
      <a class="item" data-title="Deprecated Alternatives" href="/docs/getting-started-guides/alternatives/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Hosted Solutions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Running Kubernetes on Google Kubernetes Engine" href="https://cloud.google.com/kubernetes-engine/docs/before-you-begin/"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on Azure Container Service" href="https://docs.microsoft.com/en-us/azure/container-service/container-service-kubernetes-walkthrough"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on IBM Cloud Container Service" href="https://console.bluemix.net/docs/containers/container_index.html"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Turn-key Cloud Solutions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="在 Google 计算引擎上运行 Kubernetes" href="/docs/getting-started-guides/gce/"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on AWS EC2" href="/docs/getting-started-guides/aws/"></a>
    
  

  

    

    
      <a class="item" data-title="在 Azure 上运行 Kubernetes" href="/docs/getting-started-guides/azure/"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on Alibaba Cloud" href="/docs/getting-started-guides/alibaba-cloud/"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on CenturyLink Cloud" href="/docs/getting-started-guides/clc/"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on IBM Cloud" href="https://github.com/patrocinio/kubernetes-softlayer"></a>
    
  

  

    

    
      <a class="item" data-title="Running Kubernetes on Multiple Clouds with Stackpoint.io" href="/docs/getting-started-guides/stackpoint/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Custom Solutions">
      <div class="container">
        
  
    <div class="item" data-title="Custom Cloud Solutions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes on Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    
  

  

    

    
      <a class="item" data-title="概览" href="/docs/getting-started-guides/kops/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Kubespray 在基础设施或云平台上安装 Kubernetes" href="/docs/getting-started-guides/kubespray/"></a>
    
  

  

    

    
  


      </div>
    </div>
  

  
    <div class="item" data-title="On-Premise VMs">
      <div class="container">
        
  

    

    
      <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    
  

  

    

    
      <a class="item" data-title="Cloudstack" href="/docs/getting-started-guides/cloudstack/"></a>
    
  

  

    

    
      <a class="item" data-title="VMware vSphere" href="/docs/getting-started-guides/vsphere/"></a>
    
  

  

    

    
      <a class="item" data-title="VMware Photon Controller" href="/docs/getting-started-guides/photon-controller/"></a>
    
  

  

    

    
      <a class="item" data-title="DCOS" href="/docs/getting-started-guides/dcos/"></a>
    
  

  

    

    
      <a class="item" data-title="CoreOS on libvirt" href="/docs/getting-started-guides/libvirt-coreos/"></a>
    
  

  

    

    
      <a class="item" data-title="oVirt" href="/docs/getting-started-guides/ovirt/"></a>
    
  

  

    

    
      <a class="item" data-title="OpenStack Heat" href="/docs/getting-started-guides/openstack-heat/"></a>
    
  

  
    <div class="item" data-title="rkt">
      <div class="container">
        
  

    

    
      <a class="item" data-title="通过 rkt 运行 Kubernetes" href="/docs/getting-started-guides/rkt/"></a>
    
  

  

    

    
      <a class="item" data-title="Known Issues when Using rkt" href="/docs/getting-started-guides/rkt/notes/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Kubernetes on Mesos" href="/docs/getting-started-guides/mesos/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes on Mesos on Docker" href="/docs/getting-started-guides/mesos-docker/"></a>
    
  

  
    <div class="item" data-title="Bare Metal">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Offline" href="/docs/getting-started-guides/coreos/bare_metal_offline/"></a>
    
  

  

    

    
      <a class="item" data-title="Fedora via Ansible" href="/docs/getting-started-guides/fedora/fedora_ansible_config/"></a>
    
  

  

    

    
      <a class="item" data-title="Fedora (Single Node)" href="/docs/getting-started-guides/fedora/fedora_manual_config/"></a>
    
  

  

    

    
      <a class="item" data-title="Fedora (Multi Node)" href="/docs/getting-started-guides/fedora/flannel_multi_node_cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="CentOS" href="/docs/getting-started-guides/centos/centos_manual_config/"></a>
    
  

  

    

    
      <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes on Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    
  

  
    <div class="item" data-title="Ubuntu">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Kubernetes on Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    
  

  

    

    
      <a class="item" data-title="Validation - End-to-end Testing" href="/docs/getting-started-guides/ubuntu/validation/"></a>
    
  

  

    

    
      <a class="item" data-title="备份" href="/docs/getting-started-guides/ubuntu/backups/"></a>
    
  

  

    

    
      <a class="item" data-title="Upgrades" href="/docs/getting-started-guides/ubuntu/upgrades/"></a>
    
  

  

    

    
      <a class="item" data-title="Scaling" href="/docs/getting-started-guides/ubuntu/scaling/"></a>
    
  

  

    

    
      <a class="item" data-title="Setting up Kubernetes with Juju" href="/docs/getting-started-guides/ubuntu/installation/"></a>
    
  

  

    

    
      <a class="item" data-title="监控" href="/docs/getting-started-guides/ubuntu/monitoring/"></a>
    
  

  

    

    
      <a class="item" data-title="Networking" href="/docs/getting-started-guides/ubuntu/networking/"></a>
    
  

  

    

    
      <a class="item" data-title="Security Considerations" href="/docs/getting-started-guides/ubuntu/security/"></a>
    
  

  

    

    
      <a class="item" data-title="Storage" href="/docs/getting-started-guides/ubuntu/storage/"></a>
    
  

  

    

    
      <a class="item" data-title="Troubleshooting" href="/docs/getting-started-guides/ubuntu/troubleshooting/"></a>
    
  

  

    

    
      <a class="item" data-title="Decommissioning" href="/docs/getting-started-guides/ubuntu/decommissioning/"></a>
    
  

  

    

    
      <a class="item" data-title="Operational Considerations" href="/docs/getting-started-guides/ubuntu/operational-considerations/"></a>
    
  

  

    

    
      <a class="item" data-title="Glossary and Terminology" href="/docs/getting-started-guides/ubuntu/glossary/"></a>
    
  

  

    

    
      <a class="item" data-title="Local Kubernetes development with LXD" href="/docs/getting-started-guides/ubuntu/local/"></a>
    
  

  

    

    
      <a class="item" data-title="日志" href="/docs/getting-started-guides/ubuntu/logging/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Windows Server 容器" href="/docs/getting-started-guides/windows/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Validate Node Setup" href="/docs/admin/node-conformance/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="安装扩展（Addons）" href="/docs/concepts/cluster-administration/addons/"></a>
    
  

  

    

    
      <a class="item" data-title="Configuring Kubernetes with Salt" href="/docs/admin/salt/"></a>
    
  

  

    

    
      <a class="item" data-title="搭建大型集群" href="/docs/admin/cluster-large/"></a>
    
  

  

    

    
      <a class="item" data-title="Running in Multiple Zones" href="/docs/admin/multiple-zones/"></a>
    
  

  

    

    
      <a class="item" data-title="构建高可用集群" href="/docs/admin/high-availability/"></a>
    
  

  

    

    
      <a class="item" data-title="下载或构建 Kubernetes" href="/docs/getting-started-guides/binary_release/"></a>
    
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/ubuntu/installation.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Setting up Kubernetes with Juju</h1>
        

        
<p>Ubuntu 16.04 已公开 <a href="https://www.ubuntu.com/cloud/kubernetes">Kubernetes 的 Canonical 发行版 </a>, 一套为生产环境设计的 Kubernetes 上游版本。本文将为您演示如何部署集群。</p>

<ul id="markdown-toc">
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before you begin</a></li>
  <li><a href="#部署概述" id="markdown-toc-部署概述">部署概述</a></li>
  <li><a href="#支持级别" id="markdown-toc-支持级别">支持级别</a></li>
  <li><a href="#配置-juju-以便使用您的-cloud-provider" id="markdown-toc-配置-juju-以便使用您的-cloud-provider">配置 Juju 以便使用您的 cloud provider</a></li>
  <li><a href="#启动-kubernetes-集群" id="markdown-toc-启动-kubernetes-集群">启动 Kubernetes 集群</a></li>
  <li><a href="#监控部署" id="markdown-toc-监控部署">监控部署</a></li>
  <li><a href="#与集群的交互" id="markdown-toc-与集群的交互">与集群的交互</a></li>
  <li><a href="#扩容集群" id="markdown-toc-扩容集群">扩容集群</a></li>
  <li><a href="#扩展集群" id="markdown-toc-扩展集群">扩展集群</a></li>
  <li><a href="#终止集群" id="markdown-toc-终止集群">终止集群</a></li>
  <li><a href="#更多信息" id="markdown-toc-更多信息">更多信息</a></li>
</ul>

<h2 id="before-you-begin">Before you begin</h2>

<ul>
  <li>一个运行的 <a href="https://jujucharms.com/docs/2.2/reference-install">Juju 客户端</a>；可以是一台 Linux，也可以是 Windows 或 OSX。</li>
  <li>一个 <a href="#cloud-compatibility">受支持的云</a>。
    <ul>
      <li>通过 <a href="http://maas.io">MAAS</a>  实现裸机部署。 配置指南参考 <a href="http://maas.io/docs/">MAAS 文档</a>。</li>
      <li>目前只在 OpenStack 的 Icehouse 及以上版本测试过。</li>
    </ul>
  </li>
  <li>对以下域的网络访问
    <ul>
      <li>*.jujucharms.com</li>
      <li>gcr.io</li>
      <li>github.com</li>
      <li>访问 Ubuntu 镜像源（公有或私有）</li>
    </ul>
  </li>
</ul>

<h2 id="部署概述">部署概述</h2>
<p>开箱即用的部署可以在 9 台服务器上完成以下的组件：</p>

<ul>
  <li>Kubernetes （自动地部署，操作及扩展）
    <ul>
      <li>具有一个主节点和两个工作节点的三节点 Kubernetes 集群。</li>
      <li>启用 TLS 用于单元之间的安全通信。</li>
      <li>Flannel 软件定义网络 (SDN) 插件</li>
      <li>一个负载均衡器以实现 kubernetes-master 的高可用 (实验阶段)</li>
      <li>可选的 Ingress Controller （在工作节点）</li>
      <li>可选的 Dashboard 插件 （在主节点）， 包含实现集群监控的 Heapster</li>
    </ul>
  </li>
  <li>EasyRSA
    <ul>
      <li>扮演一个证书颁发机构的角色，可以提供自签名证书</li>
    </ul>
  </li>
  <li>ETCD （分布式键值存储）
    <ul>
      <li>三节点的高可用集群。</li>
    </ul>
  </li>
</ul>

<p>Juju Kubernetes 项目由 Canonical Ltd（https://www.canonical.com/） 的 Big Software 团队策划，您可以获知我们是如何做的。如果您发现任何问题，请打开 <a href="https://github.com/juju-solutions/bundle-canonical-kubernetes">issue on our tracker</a>，以便我们解决。</p>

<h2 id="支持级别">支持级别</h2>

<table>
  <thead>
    <tr>
      <th>IaaS 提供商</th>
      <th>配置管理</th>
      <th>系统</th>
      <th>网络</th>
      <th>文档</th>
      <th>符合</th>
      <th>支持级别</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Amazon Web Services (AWS)</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel, calico*</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>OpenStack</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel, calico</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>Microsoft Azure</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>Google Compute Engine (GCE)</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel, calico</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>Joyent</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>Rackspace</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>VMWare vSphere</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel, calico</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
    <tr>
      <td>Bare Metal (MAAS)</td>
      <td>Juju</td>
      <td>Ubuntu</td>
      <td>flannel, calico</td>
      <td><a href="/docs/getting-started-guides/ubuntu">docs</a></td>
      <td> </td>
      <td><a href="https://ubuntu.com/cloud/kubernetes">Commercial</a>, <a href="https://github.com/juju-solutions/bundle-kubernetes-core">Community</a></td>
    </tr>
  </tbody>
</table>

<p>有关所有解决方案的支持级别信息，请参见 <a href="/docs/getting-started-guides/#table-of-solutions">解决方案表</a>。</p>

<h2 id="配置-juju-以便使用您的-cloud-provider">配置 Juju 以便使用您的 cloud provider</h2>

<p>可以在 <a href="#cloud-compatibility">各种公有云</a>，私有 OpenStack 云，或者是原始的裸机集群上部署集群软件。通过 <a href="http://maas.io">MAAS</a>  实现裸机部署。</p>

<p>确定部署在哪类云上后，按照 <a href="https://jujucharms.com/docs/devel/getting-started">云安装界面</a> 配置部署到该云。</p>

<p>为您使用的 cloud provider 加载 <a href="https://jujucharms.com/docs/2.2/credentials">云凭证</a></p>

<p>在本例中</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju add-credential aws
credential name: my_credentials
select auth-type [userpass, oauth, etc]: userpass
enter username: jorge
enter password: *******
</code></pre></div></div>

<p>您也可以使用 <code class="highlighter-rouge">juju autoload-credentials</code> 命令自动加载常用的云凭证，该命令将自动从每个云的默认文件和环境变量中导入凭据。</p>

<p>接下来，我们需要引导一个 controller 来管理集群。您需要定义要引导的云，区域以及任意一个 controller 节点名：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju update-clouds # 这个命令可以确保客户端上所有最新的区域是最新的
juju bootstrap aws/us-east-2
</code></pre></div></div>
<p>或者，另外一个例子，这次在 Azure 上：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju bootstrap azure/centralus
</code></pre></div></div>

<p>您需要为部署到的每个云或区域分配一个 controller 节点。有关更多信息，请参阅<a href="https://jujucharms.com/docs/2.2/controllers">controller文档</a>。</p>

<p>请注意，每个 controller 可以在给定的云或区域中托管多个 Kubernetes 集群。</p>

<h2 id="启动-kubernetes-集群">启动 Kubernetes 集群</h2>

<p>以下命令将部署 9 节点的初始启动集群。执行速度取决于您要部署到的云的性能：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju deploy canonical-kubernetes
</code></pre></div></div>

<p>执行此命令后，云将启动实例并开始部署过程。</p>

<h2 id="监控部署">监控部署</h2>

<p><code class="highlighter-rouge">juju status</code> 命令提供集群中每个单元的信息。<code class="highlighter-rouge">watch -c juju status --color</code>命令可以获取集群部署的实时状态。当所有的状态是绿色的并且“空闲”时，表示集群已准备好：</p>

<p>juju status</p>

<p>Output:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model    Controller     Cloud/Region   Version
default  aws-us-east-2  aws/us-east-2  2.0.1

App                    Version  Status       Scale  Charm                  Store       Rev  OS      Notes
easyrsa                3.0.1    active           1  easyrsa                jujucharms    3  ubuntu  
etcd                   3.1.2    active           3  etcd                   jujucharms   14  ubuntu  
flannel                0.6.1    maintenance      4  flannel                jujucharms    5  ubuntu  
kubeapi-load-balancer  1.10.0   active           1  kubeapi-load-balancer  jujucharms    3  ubuntu  exposed
kubernetes-master      1.6.1    active           1  kubernetes-master      jujucharms    6  ubuntu  
kubernetes-worker      1.6.1    active           3  kubernetes-worker      jujucharms    8  ubuntu  exposed
topbeat                         active           3  topbeat                jujucharms    5  ubuntu  

Unit                      Workload     Agent  Machine  Public address  Ports            Message
easyrsa/0*                active       idle   0        52.15.95.92                      Certificate Authority connected.
etcd/0                    active       idle   3        52.15.79.127    2379/tcp         Healthy with 3 known peers.
etcd/1*                   active       idle   4        52.15.111.66    2379/tcp         Healthy with 3 known peers. (leader)
etcd/2                    active       idle   5        52.15.144.25    2379/tcp         Healthy with 3 known peers.
kubeapi-load-balancer/0*  active       idle   7        52.15.84.179    443/tcp          Loadbalancer ready.
kubernetes-master/0*      active       idle   8        52.15.106.225   6443/tcp         Kubernetes master services ready.
flannel/3               active       idle            52.15.106.225                    Flannel subnet 10.1.48.1/24
kubernetes-worker/0*      active       idle   9        52.15.153.246                    Kubernetes worker running.
flannel/2               active       idle            52.15.153.246                    Flannel subnet 10.1.53.1/24
kubernetes-worker/1       active       idle   10       52.15.52.103                     Kubernetes worker running.
flannel/0*              active       idle            52.15.52.103                     Flannel subnet 10.1.31.1/24
kubernetes-worker/2       active       idle   11       52.15.104.181                    Kubernetes worker running.
flannel/1               active       idle            52.15.104.181                    Flannel subnet 10.1.83.1/24

Machine  State    DNS            Inst id              Series  AZ
0        started  52.15.95.92    i-06e66414008eca61c  xenial  us-east-2c
3        started  52.15.79.127   i-0038186d2c5103739  xenial  us-east-2b
4        started  52.15.111.66   i-0ac66c86a8ec93b18  xenial  us-east-2a
5        started  52.15.144.25   i-078cfe79313d598c9  xenial  us-east-2c
7        started  52.15.84.179   i-00fd70321a51b658b  xenial  us-east-2c
8        started  52.15.106.225  i-0109a5fc942c53ed7  xenial  us-east-2b
9        started  52.15.153.246  i-0ab63e34959cace8d  xenial  us-east-2b
10       started  52.15.52.103   i-0108a8cc0978954b5  xenial  us-east-2a
11       started  52.15.104.181  i-0f5562571c649f0f2  xenial  us-east-2c
</code></pre></div></div>

<h2 id="与集群的交互">与集群的交互</h2>

<p>部署集群后，您可以在任意一个 kubernetes-master 或 kubernetes-worker 节点取得集群的控制权。</p>

<p>首先，您需要将凭据和客户端程序下载到本地：</p>

<p>创建 kubectl config 目录。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir -p ~/.kube
</code></pre></div></div>
<p>将 kubeconfig 文件复制到默认位置。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju scp kubernetes-master/0:config ~/.kube/config
</code></pre></div></div>

<p>基于已部署的系统架构，获取相应的二进制文件。如果您的客户端是另一套系统架构，您需要通过其他方式获得合适的 <code class="highlighter-rouge">kubectl</code> 文件。本例中，为方便起见，我们把 kubectl 复制到 <code class="highlighter-rouge">~/bin</code>，默认该路径在 $PATH 里。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir -p ~/bin
juju scp kubernetes-master/0:kubectl ~/bin/kubectl
</code></pre></div></div>

<p>查询集群：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl cluster-info
</code></pre></div></div>

<p>输出:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Kubernetes master is running at https://52.15.104.227:443
Heapster is running at https://52.15.104.227:443/api/v1/namespaces/kube-system/services/heapster/proxy
KubeDNS is running at https://52.15.104.227:443/api/v1/namespaces/kube-system/services/kube-dns/proxy
Grafana is running at https://52.15.104.227:443/api/v1/namespaces/kube-system/services/monitoring-grafana/proxy
InfluxDB is running at https://52.15.104.227:443/api/v1/namespaces/kube-system/services/monitoring-influxdb/proxy
</code></pre></div></div>

<p>恭喜，您已经启动了一个 Kubernetes 集群。</p>

<h2 id="扩容集群">扩容集群</h2>

<p>需要更强大的 Kubernetes 节点？通过使用 Juju 的 <strong>约束</strong> ，您可以轻松地请求不同规模的云资源。通过 Juju 请求创建的任意系统，您都可以为它们增加 CPU 和内存（RAM）数量。这使您可以微调 Kubernetes 集群以适应工作负载。在 bootstrap 命令上使用该标志或使用独立的 <code class="highlighter-rouge">juju constraints</code> 命令。请参阅 <a href="https://jujucharms.com/docs/2.2/charms-constraints">和机器相关的 Juju 文档</a></p>

<h2 id="扩展集群">扩展集群</h2>

<p>需要更多的节点？只需添加一些单元：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju add-unit kubernetes-worker
</code></pre></div></div>

<p>或者一次添加多个：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju add-unit <span class="nt">-n3</span> kubernetes-worker
</code></pre></div></div>
<p>您也可以为特定实例类型或者特定机器的设置约束。参考 <a href="https://jujucharms.com/docs/stable/reference-constraints">约束文档</a>。接下来举一些例子，请注意，诸如 <code class="highlighter-rouge">cores</code> 和 <code class="highlighter-rouge">mem</code> 这样的通用约束在各个云之间是可移植的。在本例中，我们从 AWS 申请一个特定的实例类型：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju set-constraints kubernetes-worker instance-type<span class="o">=</span>c4.large
juju add-unit kubernetes-worker
</code></pre></div></div>

<p>为提升 key/value 存储的高容错性，您也可以扩展 etcd：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju add-unit <span class="nt">-n3</span> etcd
</code></pre></div></div>
<p>强烈建议使用奇数个的法定选举单元。</p>

<h2 id="终止集群">终止集群</h2>

<p>如果你想停止服务器，你可以销毁 Juju 模型或 controller。使用 <code class="highlighter-rouge">juju switch</code> 命令获取当前的 controller 名称：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>juju switch
juju destroy-controller <span class="nv">$controllername</span> <span class="nt">--destroy-all-models</span>
</code></pre></div></div>
<p>这将关闭并终止该云上所有正在运行的实例。</p>

<h2 id="更多信息">更多信息</h2>

<p>Ubuntu Kubernetes 的部署通过开源软件或代码操作管理，这被称作 charms。这些 charms 以层的方式组装，从而使代码更小，更专注于 Kubernetes 及其组件的操作。</p>

<p>Kubernetes 的层和 Bundle 可以在 github.com 的 <code class="highlighter-rouge">kubernetes</code> 项目中找到：</p>

<ul>
  <li><a href="https://git.k8s.io/kubernetes/cluster/juju/bundles">Bundle 的地址</a></li>
  <li><a href="https://git.k8s.io/kubernetes/cluster/juju/layers">Kubernetes charm 层的地址</a></li>
  <li><a href="https://jujucharms.com/kubernetes">Canonical Kubernetes home</a></li>
  <li><a href="https://github.com/juju-solutions/bundle-canonical-kubernetes">跟踪主要 issue</a></li>
</ul>

<p>欢迎提供功能需求，错误报告，pull 请求和反馈意见。</p>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/ubuntu/installation.md?pixel" alt="Analytics" /></a></p>
        
	
        <script type="text/javascript">
            PDRTJS_settings_8345992 = {
                "id" : "8345992",
                "unique_id" : "/docs/getting-started-guides/ubuntu/installation/",
                "title" : "Setting up Kubernetes with Juju",
                "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/ubuntu/installation/"
            };
            (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
        <a href="" onclick="window.open('https://github.com/kubernetes/kubernetes.github.io/issues/new?title=Issue%20with%20' +
        'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
	
        
          <a href="/editdocs#docs/getting-started-guides/ubuntu/installation.md" class="button issue">Edit this Page</a>
        
    
    </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            <a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a>
            <a href="/docs/home/">Documentation</a>
            <a href="http://blog.kubernetes.io/">Blog</a>
            <a href="/partners/">Partners</a>
            <a href="/community/">Community</a>
            <a href="/case-studies/">Case Studies</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                <a href="/docs/setup/pick-right-solution/" class="button">Get Kubernetes</a>
                <a href="https://github.com/kubernetes/kubernetes" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2017 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2017 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">https://www.linuxfoundation.org/trademark-usage</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
