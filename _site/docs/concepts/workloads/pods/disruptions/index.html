
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    

<!Doctype html>
<html id="docs" class="Concepts">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="Disruptions" />
    

    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Disruptions | Kubernetes</title>
<meta property="og:title" content="Disruptions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://0.0.0.0:4000/docs/concepts/workloads/pods/disruptions/" />
<meta property="og:url" content="http://0.0.0.0:4000/docs/concepts/workloads/pods/disruptions/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"name":null,"description":"Production-Grade Container Orchestration","author":null,"@type":"WebPage","url":"http://0.0.0.0:4000/docs/concepts/workloads/pods/disruptions/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4000/images/favicon.png"}},"image":null,"headline":"Disruptions","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/home/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
            <li>
                <a href="#">
                    v1.8 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                  <li><a href="https://kubernetes.io/docs/home/">v1.8</a></li>
                
                  <li><a href="https://v1-7.docs.kubernetes.io/docs/home/">v1.7</a></li>
                
                  <li><a href="https://v1-6.docs.kubernetes.io/docs/home/">v1.6</a></li>
                
                  <li><a href="https://v1-5.docs.kubernetes.io/docs/">v1.5</a></li>
                
                  <li><a href="https://v1-4.docs.kubernetes.io/docs/">v1.4</a></li>
                
                </ul>
              </li>
            </li>
        </ul>
        <!-- <a href="/docs/home" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Concepts</h1>
  <h5>Detailed explanations of Kubernetes system concepts and abstractions.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/home/" >HOME</a></li>
      <li><a href="/docs/setup/" >SETUP</a></li>
      <li><a href="/docs/concepts/" class="YAH">CONCEPTS</a></li>
      <li><a href="/docs/tasks/" >TASKS</a></li>
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="Concepts" href="/docs/concepts/"></a>
    
  

  
    <div class="item" data-title="Overview">
      <div class="container">
        
  

    

    
      <a class="item" data-title="认识 Kubernetes?" href="/docs/concepts/overview/what-is-kubernetes/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes 组件" href="/docs/concepts/overview/components/"></a>
    
  

  
    <div class="item" data-title="Working with Kubernetes Objects">
      <div class="container">
        
  

    

    
      <a class="item" data-title="理解 Kubernetes 对象" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>
    
  

  

    

    
      <a class="item" data-title="Names" href="/docs/concepts/overview/working-with-objects/names/"></a>
    
  

  

    

    
      <a class="item" data-title="Namespaces" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>
    
  

  

    

    
      <a class="item" data-title="Labels 和 Selectors" href="/docs/concepts/overview/working-with-objects/labels/"></a>
    
  

  

    

    
      <a class="item" data-title="Annotations" href="/docs/concepts/overview/working-with-objects/annotations/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Kubernetes API" href="/docs/concepts/overview/kubernetes-api/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Kubernetes Architecture">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Nodes" href="/docs/concepts/architecture/nodes/"></a>
    
  

  

    

    
      <a class="item" data-title="Master 节点通信" href="/docs/concepts/architecture/master-node-communication/"></a>
    
  

  

    

    
      <a class="item" data-title="云控制器管理器的基础概念" href="/docs/concepts/architecture/cloud-controller/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Extending Kubernetes">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Extending your Kubernetes Cluster" href="/docs/concepts/overview/extending/"></a>
    
  

  
    <div class="item" data-title="Extending the Kubernetes API">
      <div class="container">
        
  

    

    
      <a class="item" data-title="使用聚合层扩展Kubernetes API" href="/docs/concepts/api-extension/apiserver-aggregation/"></a>
    
  

  

    

    
      <a class="item" data-title="自定义资源" href="/docs/concepts/api-extension/custom-resources/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Compute, Storage, and Networking Extensions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="网络插件" href="/docs/concepts/cluster-administration/network-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="设备插件" href="/docs/concepts/cluster-administration/device-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="Using Sysctls in a Kubernetes Cluster" href="/docs/concepts/cluster-administration/sysctl-cluster/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Service Catalog" href="/docs/concepts/service-catalog/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Containers">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Images" href="/docs/concepts/containers/images/"></a>
    
  

  

    

    
      <a class="item" data-title="容器环境变量" href="/docs/concepts/containers/container-environment-variables/"></a>
    
  

  

    

    
      <a class="item" data-title="容器生命周期的钩子" href="/docs/concepts/containers/container-lifecycle-hooks/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Workloads">
      <div class="container">
        
  
    <div class="item" data-title="Pods">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Pod Overview" href="/docs/concepts/workloads/pods/pod-overview/"></a>
    
  

  

    

    
      <a class="item" data-title="Pods" href="/docs/concepts/workloads/pods/pod/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 生命周期" href="/docs/concepts/workloads/pods/pod-lifecycle/"></a>
    
  

  

    

    
      <a class="item" data-title="Init 容器" href="/docs/concepts/workloads/pods/init-containers/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod Preset" href="/docs/concepts/workloads/pods/podpreset/"></a>
    
  

  

    

    
      <a class="item" data-title="Disruptions" href="/docs/concepts/workloads/pods/disruptions/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Controllers">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Replica Sets" href="/docs/concepts/workloads/controllers/replicaset/"></a>
    
  

  

    

    
      <a class="item" data-title="Replication Controller" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>
    
  

  

    

    
      <a class="item" data-title="Deployment" href="/docs/concepts/workloads/controllers/deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="StatefulSet" href="/docs/concepts/workloads/controllers/statefulset/"></a>
    
  

  

    

    
      <a class="item" data-title="Daemon Sets" href="/docs/concepts/workloads/controllers/daemonset/"></a>
    
  

  

    

    
      <a class="item" data-title="垃圾收集" href="/docs/concepts/workloads/controllers/garbage-collection/"></a>
    
  

  

    

    
      <a class="item" data-title="Jobs - Run to Completion" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>
    
  

  

    

    
      <a class="item" data-title="Cron Job" href="/docs/concepts/workloads/controllers/cron-jobs/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  

  
    <div class="item" data-title="Configuration">
      <div class="container">
        
  

    

    
      <a class="item" data-title="配置最佳实践" href="/docs/concepts/configuration/overview/"></a>
    
  

  

    

    
      <a class="item" data-title="Managing Compute Resources for Containers" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>
    
  

  

    

    
      <a class="item" data-title="Assigning Pods to Nodes" href="/docs/concepts/configuration/assign-pod-node/"></a>
    
  

  

    

    
      <a class="item" data-title="Taint 和 Toleration" href="/docs/concepts/configuration/taint-and-toleration/"></a>
    
  

  

    

    
      <a class="item" data-title="Secret" href="/docs/concepts/configuration/secret/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 kubeconfig 文件组织集群访问" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 优先级和抢占" href="/docs/concepts/configuration/pod-priority-preemption/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Services, Load Balancing, and Networking">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Service" href="/docs/concepts/services-networking/service/"></a>
    
  

  

    

    
      <a class="item" data-title="DNS Pod 与 Service" href="/docs/concepts/services-networking/dns-pod-service/"></a>
    
  

  

    

    
      <a class="item" data-title="应用连接到 Service" href="/docs/concepts/services-networking/connect-applications-service/"></a>
    
  

  

    

    
      <a class="item" data-title="Ingress resource" href="/docs/concepts/services-networking/ingress/"></a>
    
  

  

    

    
      <a class="item" data-title="Network Policies" href="/docs/concepts/services-networking/network-policies/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 HostAliases 向 Pod /etc/hosts 文件添加条目" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Storage">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Volumes" href="/docs/concepts/storage/volumes/"></a>
    
  

  

    

    
      <a class="item" data-title="Persistent Volumes" href="/docs/concepts/storage/persistent-volumes/"></a>
    
  

  

    

    
      <a class="item" data-title="Storage Classes" href="/docs/concepts/storage/storage-classes/"></a>
    
  

  

    

    
      <a class="item" data-title="Dynamic Volume Provisioning" href="/docs/concepts/storage/dynamic-provisioning/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Cluster Administration">
      <div class="container">
        
  

    

    
      <a class="item" data-title="集群管理概述" href="/docs/concepts/cluster-administration/cluster-administration-overview/"></a>
    
  

  

    

    
      <a class="item" data-title="证书" href="/docs/concepts/cluster-administration/certificates/"></a>
    
  

  

    

    
      <a class="item" data-title="云供应商" href="/docs/concepts/cluster-administration/cloud-providers/"></a>
    
  

  

    

    
      <a class="item" data-title="Managing Resources" href="/docs/concepts/cluster-administration/manage-deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="集群网络" href="/docs/concepts/cluster-administration/networking/"></a>
    
  

  

    

    
      <a class="item" data-title="网络插件" href="/docs/concepts/cluster-administration/network-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="日志架构" href="/docs/concepts/cluster-administration/logging/"></a>
    
  

  

    

    
      <a class="item" data-title="配置 kubelet 垃圾收集" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>
    
  

  

    

    
      <a class="item" data-title="Federation" href="/docs/concepts/cluster-administration/federation/"></a>
    
  

  

    

    
      <a class="item" data-title="Using Sysctls in a Kubernetes Cluster" href="/docs/concepts/cluster-administration/sysctl-cluster/"></a>
    
  

  

    

    
  

  

    

    
  

  

    

    
      <a class="item" data-title="Proxies in Kubernetes" href="/docs/concepts/cluster-administration/proxies/"></a>
    
  

  

    

    
      <a class="item" data-title="Controller manager metrics" href="/docs/concepts/cluster-administration/controller-metrics/"></a>
    
  

  

    

    
      <a class="item" data-title="设备插件" href="/docs/concepts/cluster-administration/device-plugins/"></a>
    
  

  
    <div class="item" data-title="Policies">
      <div class="container">
        
  

    

    
      <a class="item" data-title="资源配额" href="/docs/concepts/policy/resource-quotas/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 安全策略" href="/docs/concepts/policy/pod-security-policy/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/concepts/workloads/pods/disruptions.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Disruptions</h1>
        

        
<p>This guide is for application owners who want to build
highly available applications, and thus need to understand
what types of Disruptions can happen to Pods.</p>

<p>It is also for Cluster Administrators who want to perform automated
cluster actions, like upgrading and autoscaling clusters.</p>

<ul id="markdown-toc">
  <li><a href="#voluntary-and-involuntary-disruptions" id="markdown-toc-voluntary-and-involuntary-disruptions">Voluntary and Involuntary Disruptions</a></li>
  <li><a href="#dealing-with-disruptions" id="markdown-toc-dealing-with-disruptions">Dealing with Disruptions</a></li>
  <li><a href="#how-disruption-budgets-work" id="markdown-toc-how-disruption-budgets-work">How Disruption Budgets Work</a></li>
  <li><a href="#pdb-example" id="markdown-toc-pdb-example">PDB Example</a></li>
  <li><a href="#separating-cluster-owner-and-application-owner-roles" id="markdown-toc-separating-cluster-owner-and-application-owner-roles">Separating Cluster Owner and Application Owner Roles</a></li>
  <li><a href="#how-to-perform-disruptive-actions-on-your-cluster" id="markdown-toc-how-to-perform-disruptive-actions-on-your-cluster">How to perform Disruptive Actions on your Cluster</a></li>
  <li><a href="#whats-next" id="markdown-toc-whats-next">What’s next</a></li>
</ul>

<h2 id="voluntary-and-involuntary-disruptions">Voluntary and Involuntary Disruptions</h2>

<p>Pods do not disappear until someone (a person or a controller) destroys them, or
there is an unavoidable hardware or system software error.</p>

<p>We call these unavoidable cases <em>involuntary disruptions</em> to
an application.  Examples are:</p>

<ul>
  <li>a hardware failure of the physical machine backing the node</li>
  <li>cluster administrator deletes VM (instance) by mistake</li>
  <li>cloud provider or hypervisor failure makes VM disappear</li>
  <li>a kernel panic</li>
  <li>if the node to disappears from the cluster due to cluster network partition</li>
  <li>eviction of a pod due to the node being <a href="/docs/tasks/administer-cluster/out-of-resource.md">out-of-resources</a>.</li>
</ul>

<p>Except for the out-of-resources condition, all these conditions
should be familiar to most users; they are are not specific
to Kubernetes.</p>

<p>We call other cases <em>voluntary disruptions</em>.  These include both
actions initiated by the application owner and those initiated by a Cluster
Administrator.  Typical application owner actions include:</p>

<ul>
  <li>deleting the deployment or other controller that manages the pod</li>
  <li>updating a deployment’s pod template causing a restart</li>
  <li>directly deleting a pod (e.g. by accident)</li>
</ul>

<p>Cluster Administrator actions include:</p>

<ul>
  <li><a href="/docs//tasks/administer-cluster/safely-drain-node.md">Draining a node</a> for repair or upgrade.</li>
  <li>Draining a node from a cluster to scale the cluster down (learn about
<a href="/docs/tasks/administer-cluster/cluster-management/#cluster-autoscaler">Cluster Autoscaling</a>
).</li>
  <li>Removing a pod from a node to permit something else to fit on that node.</li>
</ul>

<p>These actions might be taken directly by the cluster administrator, or by automation
run by the cluster administrator, or by your cluster hosting provider.</p>

<p>Ask your cluster administrator or consult your cloud provider or distribution documentation
to determine if any sources of voluntary disruptions are enabled for your cluster.
If none are enabled, you can skip creating Pod Disruption Budgets.</p>

<h2 id="dealing-with-disruptions">Dealing with Disruptions</h2>

<p>Here are some ways to mitigate involuntary disruptions:</p>

<ul>
  <li>Ensure your pod <a href="/docs/tasks/configure-pod-container/assign-cpu-ram-container">requests the resources</a> it needs.</li>
  <li>Replicate your application if you need higher availability.  (Learn about running replicated
<a href="/docs/tasks/run-application/run-stateless-application-deployment.md">stateless</a>
and <a href="/docs/tasks/run-application/run-replicated-stateful-application.md">stateful</a> applications.)</li>
  <li>For even higher availability when running replicated applications,
spread applications across racks (using
<a href="/docs/user-guide/node-selection/#inter-pod-affinity-and-anti-affinity-beta-feature">anti-affinity</a>)
or across zones (if using a
<a href="/docs/admin/multiple-zones">multi-zone cluster</a>.)</li>
</ul>

<p>The frequency of voluntary disruptions varies.  On a basic Kubernetes cluster, there are
no voluntary disruptions at all.  However, your cluster administrator or hosting provider
may run some additional services which cause voluntary disruptions.  For example,
rolling out node software updates can cause voluntary updates.  Also, some implementations
of cluster (node) autoscaling may cause voluntary disruptions to defragment and compact nodes.
You cluster administrator or hosting provider should have documented what level of voluntary
disruptions, if any, to expect.</p>

<p>Kubernetes offers features to help run highly available applications at the same
time as frequent voluntary disruptions.  We call this set of features
<em>Disruption Budgets</em>.</p>

<h2 id="how-disruption-budgets-work">How Disruption Budgets Work</h2>

<p>An Application Owner can create a <code class="highlighter-rouge">PodDisruptionBudget</code> object (PDB) for each application.
A PDB limits the number pods of a replicated application that are down simultaneously from
voluntary disruptions.  For example, a quorum-based application would
like to ensure that the number of replicas running is never brought below the
number needed for a quorum. A web front end might want to
ensure that the number of replicas serving load never falls below a certain
percentage of the total.</p>

<p>Cluster managers and hosting providers should use tools which
respect Pod Disruption Budgets by calling the <a href="/docs/tasks/administer-cluster/safely-drain-node/#the-eviction-api">Eviction API</a>
instead of directly deleting pods.  Examples are the <code class="highlighter-rouge">kubectl drain</code> command
and the Kubernetes-on-GCE cluster upgrade script (<code class="highlighter-rouge">cluster/gce/upgrade.sh</code>).</p>

<p>When a cluster administrator wants to drain a node
they use the <code class="highlighter-rouge">kubectl drain</code> command.  That tool tries to evict all
the pods on the machine.  The eviction request may be temporarily rejected,
and the tool periodically retries all failed requests until all pods
are terminated, or until a configurable timeout is reached.</p>

<p>A PDB specifies the number of replicas that an application can tolerate having, relative to how
many it is intended to have.  For example, a Deployment which has a <code class="highlighter-rouge">spec.replicas: 5</code> is
supposed to have 5 pods at any given time.  If its PDB allows for there to be 4 at a time,
then the Eviction API will allow voluntary disruption of one, but not two pods, at a time.</p>

<p>The group of pods that comprise the application is specified using a label selector, the same
as the one used by the application’s controller (deployment, stateful-set, etc).</p>

<p>The “intended” number of pods is computed from the <code class="highlighter-rouge">.spec.replicas</code> of the pods controller.
The controller is discovered from the pods using the <code class="highlighter-rouge">.metadata.ownerReferences</code> of the object.</p>

<p>PDBs cannot prevent <a href="#voluntary-and-involuntary-disruptions">involuntary disruptions</a> from
occuring, but they do count against the budget.</p>

<p>Pods which are deleted or unavailable due to a rolling upgrade to an application do count
against the disruption budget, but controllers (like deployment and stateful-set)
are not limited by PDBs when doing rolling upgrades – the handling of failures
during application updates is configured in the controller spec.
(Learn about <a href="/docs/concepts/cluster-administration/manage-deployment/#updating-your-application-without-a-service-outage">updating a deployment</a>.)</p>

<p>When a pod is evicted using the eviction API, it is gracefully terminated (see
<code class="highlighter-rouge">terminationGracePeriodSeconds</code> in <a href="/docs/resources-reference/v1.6/#podspec-v1-core">PodSpec</a>.)</p>

<h2 id="pdb-example">PDB Example</h2>

<p>Consider a cluster with 3 nodes, <code class="highlighter-rouge">node-1</code> through <code class="highlighter-rouge">node-3</code>.
The cluster is running several applications.  One of them has 3 replicas initially called
<code class="highlighter-rouge">pod-a</code>, <code class="highlighter-rouge">pod-b</code>, and <code class="highlighter-rouge">pod-c</code>.  Another, unrelated pod without a PDB, called <code class="highlighter-rouge">pod-x</code>, is also shown.
Initially, the pods are laid out as follows:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1</th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">pod-a  <em>available</em></td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
    </tr>
    <tr>
      <td style="text-align: center">pod-x  <em>available</em></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>All 3 pods are part of an deployment, and they collectively have a PDB which requires
there be at least 2 of the 3 pods to be available at all times.</p>

<p>For example, assume the cluster administrator wants to reboot into a new kernel version to fix a bug in the kernel.
The cluster administrator first tries to drain <code class="highlighter-rouge">node-1</code> using the <code class="highlighter-rouge">kubectl drain</code> command.
That tool tries to evict <code class="highlighter-rouge">pod-a</code> and <code class="highlighter-rouge">pod-x</code>.  This succeeds immediately.
Both pods go into the <code class="highlighter-rouge">terminating</code> state at the same time.
This puts the cluster in this state:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1 <em>draining</em></th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">pod-a  <em>terminating</em></td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
    </tr>
    <tr>
      <td style="text-align: center">pod-x  <em>terminating</em></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>The deployment notices that one of the pods is terminating, so it creates a replacement
called <code class="highlighter-rouge">pod-d</code>.  Since <code class="highlighter-rouge">node-1</code> is cordoned, it lands on another node.  Something has
also created <code class="highlighter-rouge">pod-y</code> as a replacement for <code class="highlighter-rouge">pod-x</code>.</p>

<p>(Note: for a StatefulSet, <code class="highlighter-rouge">pod-a</code>, which would be called something like <code class="highlighter-rouge">pod-1</code>, would need
to terminate completely before its replacement, which is also called <code class="highlighter-rouge">pod-1</code> but has a
different UID, could be created.  Otherwise, the example applies to a StatefulSet as well.)</p>

<p>Now the cluster is in this state:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1 <em>draining</em></th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">pod-a  <em>terminating</em></td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
    </tr>
    <tr>
      <td style="text-align: center">pod-x  <em>terminating</em></td>
      <td style="text-align: center">pod-d <em>starting</em></td>
      <td style="text-align: center">pod-y</td>
    </tr>
  </tbody>
</table>

<p>At some point, the pods terminate, and the cluster look like this:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1 <em>drained</em></th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-d <em>starting</em></td>
      <td style="text-align: center">pod-y</td>
    </tr>
  </tbody>
</table>

<p>At this point, if an impatient cluster administrator tries to drain <code class="highlighter-rouge">node-2</code> or
<code class="highlighter-rouge">node-3</code>, the drain command will block, because there are only 2 available
pods for the deployment, and its PDB requires at least 2.  After some time</p>

<p>asses, <code class="highlighter-rouge">pod-d</code> becomes available.</p>

<p>The cluster state now looks like this:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1 <em>drained</em></th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-d <em>available</em></td>
      <td style="text-align: center">pod-y</td>
    </tr>
  </tbody>
</table>

<p>Now, the cluster admin tries to drain <code class="highlighter-rouge">node-2</code>.
The drain command will try to evict the two pods in some order, say 
<code class="highlighter-rouge">pod-b</code> first and then <code class="highlighter-rouge">pod-d</code>.  It will succeed at evicting <code class="highlighter-rouge">pod-b</code>.
But, when it tries to evict <code class="highlighter-rouge">pod-d</code>, it will be refused because that would leave only
one pod available for the deployment.</p>

<p>The deployment creates a replacement for <code class="highlighter-rouge">pod-b</code> called <code class="highlighter-rouge">pod-e</code>.
However, not there are not enough resources in the cluster to schedule
<code class="highlighter-rouge">pod-e</code>.  So, the drain  then the drain will block.  The cluster may end up in this
state:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">node-1 <em>drained</em></th>
      <th style="text-align: center">node-2</th>
      <th style="text-align: center">node-3</th>
      <th style="text-align: center"><em>no node</em></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-b <em>available</em></td>
      <td style="text-align: center">pod-c <em>available</em></td>
      <td style="text-align: center">pod-e <em>pending</em></td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center">pod-d <em>available</em></td>
      <td style="text-align: center">pod-y</td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>At this point, the cluster administrator needs to
add a node back to the cluster to proceed with the upgrade.</p>

<p>You can see how Kubernetes varies the rate at which disruptions
can happen, according to:</p>

<ul>
  <li>how many replicas an application needs</li>
  <li>how long it takes to gracefully shutdown an instance</li>
  <li>how long it takes a new instance to start up</li>
  <li>the type of controller</li>
  <li>the cluster’s resource capacity</li>
</ul>

<h2 id="separating-cluster-owner-and-application-owner-roles">Separating Cluster Owner and Application Owner Roles</h2>

<p>Often, it is useful to think of the Cluster Manager
and Application Owner as separate roles with limited knowledge
of each other.   This separation of responsibilities
may make sense in these scenarios:</p>

<ul>
  <li>when there are many application teams sharing a Kubernetes cluster, and 
there is natural specialization of roles</li>
  <li>when third-party tools or services are used to automate cluster management</li>
</ul>

<p>Pod Disruption Budgets support this separation of roles by providing an
interface between the roles.</p>

<p>If you do not have such a separation of responsibilities in your organization,
you may not need to use Pod Disruption Budgets.</p>

<h2 id="how-to-perform-disruptive-actions-on-your-cluster">How to perform Disruptive Actions on your Cluster</h2>

<p>If you are a Cluster Administrator, and you need to perform a disruptive action on all
the nodes in your cluster, such as a node or system software upgrade, here are some options:</p>

<ul>
  <li>Accept downtime during the upgrade.</li>
  <li>Fail over to another complete replica cluster.
    <ul>
      <li>No downtime, but may be costly both for the duplicated nodes,
   and for human effort to orchestrate the switchover.</li>
    </ul>
  </li>
  <li>Write disruption tolerant applications and use PDBs.
    <ul>
      <li>No downtime.</li>
      <li>Minimal resource duplication.</li>
      <li>Allows more automation of cluster administration.</li>
      <li>Writing disruption-tolerant applications is tricky, but the work to tolerate voluntary
disruptions largely overlaps with work to support autoscaling and tolerating
involuntary disruptions.</li>
    </ul>
  </li>
</ul>

<h2 id="whats-next">What’s next</h2>

<ul>
  <li>
    <p>Follow steps to protect your application by <a href="/docs/tasks/run-application//configure-pdb.md">configuring a Pod Disruption Budget</a>.</p>
  </li>
  <li>
    <p>Learn more about <a href="/docs/tasks/administer-cluster//safely-drain-node.md">draining nodes</a></p>
  </li>
</ul>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/concepts/workloads/pods/disruptions.md?pixel" alt="Analytics" /></a></p>
        
	
        <script type="text/javascript">
            PDRTJS_settings_8345992 = {
                "id" : "8345992",
                "unique_id" : "/docs/concepts/workloads/pods/disruptions/",
                "title" : "Disruptions",
                "permalink" : "http://kubernetes.github.io/docs/concepts/workloads/pods/disruptions/"
            };
            (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
        <a href="" onclick="window.open('https://github.com/kubernetes/kubernetes.github.io/issues/new?title=Issue%20with%20' +
        'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
	
        
          <a href="/editdocs#docs/concepts/workloads/pods/disruptions.md" class="button issue">Edit this Page</a>
        
    
    </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            <a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a>
            <a href="/docs/home/">Documentation</a>
            <a href="http://blog.kubernetes.io/">Blog</a>
            <a href="/partners/">Partners</a>
            <a href="/community/">Community</a>
            <a href="/case-studies/">Case Studies</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                <a href="/docs/setup/pick-right-solution/" class="button">Get Kubernetes</a>
                <a href="https://github.com/kubernetes/kubernetes" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2017 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2017 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">https://www.linuxfoundation.org/trademark-usage</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
